from .. import fdb


def test_calc_md5_hash_file_1():
    file_name = 'tests/md5_test_file_1'
    file_hash = b'\xb0\x83\xdd@\xe1\xf2\xb4zS\r\x135\xfd\xd9\xa4\xbd'

    calc_hash = fdb.hash_file(file_name)

    assert calc_hash == file_hash


def test_calc_md5_hash_file_2():
    file_name = 'tests/md5_test_file_2'
    expected_hash = b'gj\xeb\t\xec\xdb\xa9\xa0ac\xf6\x8a\x07\x0c\xd3\x17'

    actual_hash = fdb.hash_file(file_name)

    assert actual_hash == expected_hash


def test_convert_bin2str_1():
    barray = b'!\x00\x00\x00\xa7\x00\x00\x00\x9e\x00\x00\x00\xc4\x00\x00\x00\xf0\x00\x00\x00\xb1\x00\x00\x00\x02\x00\x00\x00h\x00\x00\x00L\x00\x00\x00`\x00\x00\x00\xa9\x00\x00\x00\xba\x00\x00\x00\x11\x00\x00\x00\xbd\x00\x00\x00g\x00\x00\x00\x9d\x00\x00\x00\x97\x00\x00\x00t\x00\x00\x00o\x00\x00\x00>\x00\x00\x00\x8c\x00\x00\x00\x99\x00\x00\x00m\x00\x00\x00\xe8\x00\x00\x00\xbb\x00\x00\x00.\x00\x00\x00\xf7\x00\x00\x00\x96\x00\x00\x00\xac\x00\x00\x00\x88\x00\x00\x00M\x00\x00\x00j\x00\x00\x00:\x00\x00\x00\xae\x00\x00\x00\xd2\x00\x00\x00\xfb\x00\x00\x00\x9a\x00\x00\x00\x1c\x00\x00\x00\x8f\x00\x00\x00\xa0\x00\x00\x00\x87\x00\x00\x00\x80\x00\x00\x00\x19\x00\x00\x00\t\x00\x00\x00\xd8\x00\x00\x00\x12\x00\x00\x00\xcc\x00\x00\x00\x8d\x00\x00\x004\x00\x00\x00\xbb\x00\x00\x00N\x00\x00\x00~\x00\x00\x00\xbb\x00\x00\x00\xad\x00\x00\x00\x8e\x00\x00\x00\xcb\x00\x00\x00\xcf\x00\x00\x00#\x00\x00\x00P\x00\x00\x00R\x00\x00\x00\x0f\x00\x00\x00\x08\x00\x00\x00i\x00\x00\x00/\x00\x00\x00\x7f\x00\x00\x00\n\x00\x00\x00+\x00\x00\x00D\x00\x00\x00\x9b\x00\x00\x00\xef\x00\x00\x00\x7f\x00\x00\x00\xfe\x00\x00\x00\x85\x00\x00\x00\xe4\x00\x00\x00G\x00\x00\x00r\x00\x00\x00>\x00\x00\x00\x1c\x00\x00\x00\xbf\x00\x00\x00\x1d\x00\x00\x00\t\x00\x00\x00&\x00\x00\x00j\x00\x00\x00K\x00\x00\x00\x90\x00\x00\x00\x8f\x00\x00\x00\xbd\x00\x00\x00\x00\x00\x00\x00 \x00\x00\x00\x8f\x00\x00\x00q\x00\x00\x00k\x00\x00\x00\xba\x00\x00\x00\x1d\x00\x00\x00\x8f\x00\x00\x00\x18\x00\x00\x00\xf2\x00\x00\x00\x7f\x00\x00\x00\xde\x00\x00\x00\xa0\x00\x00\x00'
    expected_barray_str = '21000000a70000009e000000c4000000f0000000b100000002000000680000004c00000060000000a9000000ba00000011000000bd000000670000009d00000097000000740000006f0000003e0000008c000000990000006d000000e8000000bb0000002e000000f700000096000000ac000000880000004d0000006a0000003a000000ae000000d2000000fb0000009a0000001c0000008f000000a000000087000000800000001900000009000000d800000012000000cc0000008d00000034000000bb0000004e0000007e000000bb000000ad0000008e000000cb000000cf0000002300000050000000520000000f00000008000000690000002f0000007f0000000a0000002b000000440000009b000000ef0000007f000000fe00000085000000e400000047000000720000003e0000001c000000bf0000001d00000009000000260000006a0000004b000000900000008f000000bd00000000000000200000008f000000710000006b000000ba0000001d0000008f00000018000000f20000007f000000de000000a0000000'

    actual_barray_str = fdb.bin2str(barray)

    assert actual_barray_str == expected_barray_str


def test_convert_bin2str_2():
    barray = b'!\x00\x00\x00\xa7\x00\x00\x00\x9e\x00\x00\x00\xc4\x00\x00\x00\xf0\x00\x00\x00\xb1\x00\x00\x00\x02\x00\x00\x00h\x00\x00\x00L\x00\x00\x00`\x00\x00\x00\xa9\x00\x00\x00\xba\x00\x00\x00\x11\x00\x00\x00\xbd\x00\x00\x00g\x00\x00\x00\x9d\x00\x00\x00\x97\x00\x00\x00t\x00\x00\x00o\x00\x00\x00>\x00\x00\x00\x8c\x00\x00\x00\x99\x00\x00\x00m\x00\x00\x00\xe8\x00\x00\x00\xbb\x00\x00\x00.\x00\x00\x00\xf7\x00\x00\x00\x96\x00\x00\x00\xac\x00\x00\x00\x88\x00\x00\x00M\x00\x00\x00j\x00\x00\x00:\x00\x00\x00\xae\x00\x00\x00\xd2\x00\x00\x00\xfb\x00\x00\x00\x9a\x00\x00\x00\x1c\x00\x00\x00\x8f\x00\x00\x00\xa0\x00\x00\x00\x87\x00\x00\x00\x80\x00\x00\x00\x19\x00\x00\x00\t\x00\x00\x00\xd8\x00\x00\x00\x12\x00\x00\x00\xcc\x00\x00\x00\x8d\x00\x00\x004\x00\x00\x00\xbb\x00\x00\x00N\x00\x00\x00~\x00\x00\x00\xbb\x00\x00\x00\xad\x00\x00\x00\x8e\x00\x00\x00\xcb\x00\x00\x00\xcf\x00\x00\x00#\x00\x00\x00P\x00\x00\x00R\x00\x00\x00\x0f\x00\x00\x00\x08\x00\x00\x00i\x00\x00\x00/\x00\x00\x00\x7f\x00\x00\x00\n\x00\x00\x00+\x00\x00\x00D\x00\x00\x00\x9b\x00\x00\x00\xef\x00\x00\x00\x7f\x00\x00\x00\xfe\x00\x00\x00\x85\x00\x00\x00\xe4\x00\x00\x00G\x00\x00\x00r\x00\x00\x00>\x00\x00\x00\x1c\x00\x00\x00\xbf\x00\x00\x00\x1d\x00\x00\x00\t\x00\x00\x00&\x00\x00\x00j\x00\x00\x00K\x00\x00\x00\x90\x00\x00\x00\x8f\x00\x00\x00\xbd\x00\x00\x00\x00\x00\x00\x00 \x00\x00\x00\x8f\x00\x00\x00q\x00\x00\x00k\x00\x00\x00\xba\x00\x00\x00\x1d\x00\x00\x00\x8f\x00\x00\x00\x18\x00\x00\x00\xf2\x00\x00\x00\x7f\x00\x00\x00\xde\x00\x00\x00\xa0\x00\x00\x00'
    expected_barray_str = '21000000a70000009e000000c4000000f0000000b100000002000000680000004c00000060000000a9000000ba00000011000000bd000000670000009d00000097000000740000006f0000003e0000008c000000990000006d000000e8000000bb0000002e000000f700000096000000ac000000880000004d0000006a0000003a000000ae000000d2000000fb0000009a0000001c0000008f000000a000000087000000800000001900000009000000d800000012000000cc0000008d00000034000000bb0000004e0000007e000000bb000000ad0000008e000000cb000000cf0000002300000050000000520000000f00000008000000690000002f0000007f0000000a0000002b000000440000009b000000ef0000007f000000fe00000085000000e400000047000000720000003e0000001c000000bf0000001d00000009000000260000006a0000004b000000900000008f000000bd00000000000000200000008f000000710000006b000000ba0000001d0000008f00000018000000f20000007f000000de000000a0000000'

    actual_barray_str = fdb.bin2str(barray)

    assert actual_barray_str == expected_barray_str
